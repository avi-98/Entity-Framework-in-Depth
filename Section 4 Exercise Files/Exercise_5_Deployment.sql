DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Exercise4.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202005051456584_CreateVideoAndGenreTables'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime] NOT NULL,
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202005051456584_CreateVideoAndGenreTables', N'Exercise4.Migrations.Configuration',  0x1F8B0800000000000400ED59DD6E2B3510BE47E21D567B05A827DB1F2E204ACE51495B5471DA544D5B715739BB93D4C2EB5D6C6F958078322E78245E81F1FEAFBD9BDD44470501AA5425F6FCCFE7F18CF3E7EF7F4C3E6C42E6BC829034E253F76474EC3AC0FD28A07C3D7513B57AF78DFBE1FDE79F4D2E8370E33C1574679A0E39B99CBA2F4AC563CF93FE0B84448E42EA8B48462B35F2A3D02341E49D1E1F7FEB9D9C7880225C94E53893FB842B1A42FA05BFCE22EE43AC12C26EA20098CCD77167914A756E490832263E4CDDCB0D089F4AF8DA75CE192568C002D8CA7508E791220ACD1B3F4A582811F1F522C605C21EB63120DD8A3009B9D9E38A7CA807C7A7DA03AF622C44F9895451B8A7C093B33C249EC97E5060DD326418B44B0CAEDA6AAFD3C04DDDEF810BF4DCD4349E31A1A96A411DA5A4474EB97054261DB1A1FF8E9C59C2542260CA215182B023E72E5932EAFF00DB87E827E0539E3056B7072DC2BDC6022EDD892806A1B6F7B0CAADBC0E5CC76BF2792663C956E3C95CB8E6EAECD4756E5139593228D35D7377A12201E82008A220B8234A81E05A06A401B3B41BBAF4FF421BE20B4F88EBDC90CD47E06BF53275F1A3EB5CD10D04C54A6EC123A778A0904989042C25B7E495AE53FB0C754F348048BACE3DB0745BBED03803FB28DD7A4E53850457220AEF2356B0E4EBCF0F44AC41A1C151CBE6224A846F1833F12AE0EC84532A69189C52D2FFE1F47670329420788048B8400B0B5DFAF303D5BA2DE78642B340DEA1D02CD0D70ACD02B743A0792E65E4D3D4863A360BFD4D772E79E0EC3226CB44E9046603914963C4226A9EBA5F59F1E910581EBC4A605E80770A9C78356FECF38777A42214C15639FACB36BD2E5B4E22DE80F96194394E4CCBB5C8052823A155949B865B8E37D98B5265B1E78134D86B7E1A324AE0D448DA80659EFE9ED496F656A67A034514C9AC89286C348B4BD3AD16F49629ACFA1B2F6B708A46C8EBE8842637248EB142D43AA37CC559646DD1ECDD62FFC621CC6478BE6CE91F4A6B4B4D58EFC81A8C5D548D965E5121155616B224BA90CC82D022AB01B6034D85A20626ED3C15182BC8F5E78CC568634CDE2A6A57E84888653AF509CCDCDA7C69274A18112DF7C52C6249C8BBEE9C5DDCD90D50E7CF566C0913CF30DC8C8A6785C500A719E44129C80FCB6129C8CEFEFE29E8E0FBBB53D025A171C3D6053536DE3EA5CD6AD492D7B2D67626AFA4684D51EB51D165B4AD8F352AB21D8D41B9CD44B5655847A354BCA74D79893FD0A654C89E369977859D40EBCA30494AF894578771454CF272DD3F515BF53B23711DB4FD150385B57BB1950AC29126182D7E66334611B015C10DE1740552650DBB8BD3EDA9319DFF7326654FCA800D1997DF7CE4A03AA4BD43455FD3BE63CAE0AF44F82F447C1192CD977549F624B1E72CF89F8ED5A0A92BC0CFAA7FEADA2FEE0703754721B589BB2A5C7FBE2A35B5AC59C3CA350F6033757F4D99C6CEF58FCF05DF913317585EC6CEB1F3DBDED9ACCCDE4F79C1B787F2C3C6D3D6CBD09C43FAE7D213EB0E9EF30B04A002E7DCCFAAEC8C489F0476C4F405B5537B3EFE99260C1967F52B2FAC40E8B34818DE635209BCC9AC36E74E50EED398B086D7F6653CA48268974A79E6CE05C4C07569B01D1CA26D57EF518A36C2DB1780CE91BF07386D1D4B2D7576D65A13F62F03CEF054BE2D707635889F1C38ED6F45F6843EE039A8FB3528EB0FF14E5BEAF29455C58E4791D697A2EE87A236C9ED2F36ED92BB0CAF6F76EAE870A1F7B5AA7C66DAFD68D531FBD805DF9A857B1FAB1A6E9B13DAF077AA41CE160F623DCEB60F557691B2DE5EDECAD93D1EE5EC490A4F68ED174CAC1092AE2B11FAF74C0E7EE36C9634D77C151545C2B0A820311A991B5004DB47722E145D115FE1B60F52A63F183C1196E8C13D5C4270CDE7898A13852E43B8648D1F2074A9D9A53F7D796CDA3C99C7E9DBFEA77001CDA4BA039EF3EF12CA82D2EEAB965EAA4384AE6179AFAF73A974CFBFDE96926E233E50501EBEB2F43E4018331426E77C415EE110DB1E257C8435F1B7C540DC2DA43F11CDB04F2E28590B12CA5C46C58F5F11C341B879FF1799522532C81F0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '202005051501087_PopulateGenresTable'
BEGIN
    INSERT INTO Genres VALUES ('Horror')
    INSERT INTO Genres VALUES ('Action')
    INSERT INTO Genres VALUES ('SciFi')
    INSERT INTO Genres VALUES ('Romance')
    INSERT INTO Genres VALUES ('Fiction')
    INSERT INTO Genres VALUES ('Nonfiction')
    INSERT INTO Genres VALUES ('Comedy')
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202005051501087_PopulateGenresTable', N'Exercise4.Migrations.Configuration',  0x1F8B0800000000000400ED59DD6E2B3510BE47E21D567B05A827DB1F2E204ACE51495B5471DA544D5B715739BB93D4C2EB5D6C6F958078322E78245E81F1FEAFBD9BDD44470501AA5425F6FCCFE7F18CF3E7EF7F4C3E6C42E6BC829034E253F76474EC3AC0FD28A07C3D7513B57AF78DFBE1FDE79F4D2E8370E33C1574679A0E39B99CBA2F4AC563CF93FE0B84448E42EA8B48462B35F2A3D02341E49D1E1F7FEB9D9C7880225C94E53893FB842B1A42FA05BFCE22EE43AC12C26EA20098CCD77167914A756E490832263E4CDDCB0D089F4AF8DA75CE192568C002D8CA7508E791220ACD1B3F4A582811F1F522C605C21EB63120DD8A3009B9D9E38A7CA807C7A7DA03AF622C44F9895451B8A7C093B33C249EC97E5060DD326418B44B0CAEDA6AAFD3C04DDDEF810BF4DCD4349E31A1A96A411DA5A4474EB97054261DB1A1FF8E9C59C2542260CA215182B023E72E5932EAFF00DB87E827E0539E3056B7072DC2BDC6022EDD892806A1B6F7B0CAADBC0E5CC76BF2792663C956E3C95CB8E6EAECD4756E5139593228D35D7377A12201E82008A220B8234A81E05A06A401B3B41BBAF4FF421BE20B4F88EBDC90CD47E06BF53275F1A3EB5CD10D04C54A6EC123A778A0904989042C25B7E495AE53FB0C754F348048BACE3DB0745BBED03803FB28DD7A4E53850457220AEF2356B0E4EBCF0F44AC41A1C151CBE6224A846F1833F12AE0EC84532A69189C52D2FFE1F47670329420788048B8400B0B5DFAF303D5BA2DE78642B340DEA1D02CD0D70ACD02B743A0792E65E4D3D4863A360BFD4D772E79E0EC3226CB44E9046603914963C4226A9EBA5F59F1E910581EBC4A605E80770A9C78356FECF38777A42214C15639FACB36BD2E5B4E22DE80F96194394E4CCBB5C8052823A155949B865B8E37D98B5265B1E78134D86B7E1A324AE0D448DA80659EFE9ED496F656A67A034514C9AC89286C348B4BD3AD16F49629ACFA1B2F6B708A46C8EBE8842637248EB142D43AA37CC559646DD1ECDD62FFC621CC6478BE6CE91F4A6B4B4D58EFC81A8C5D548D965E5121155616B224BA90CC82D022AB01B6034D85A20626ED3C15182BC8F5E78CC568634CDE2A6A57E84888653AF509CCDCDA7C69274A18112DF7C52C6249C8BBEE9C5DDCD90D50E7CF566C0913CF30DC8C8A6785C500A719E44129C80FCB6129C8CEFEFE29E8E0FBBB53D025A171C3D6053536DE3EA5CD6AD492D7B2D67626AFA4684D51EB51D165B4AD8F352AB21D8D41B9CD44B5655847A354BCA74D79893FD0A654C89E369977859D40EBCA30494AF894578771454CF272DD3F515BF53B23711DB4FD150385B57BB1950AC29126182D7E66334611B015C10DE1740552650DBB8BD3EDA9319DFF7326654FCA800D1997DF7CE4A03AA4BD43455FD3BE63CAE0AF44F82F447C1192CD977549F624B1E72CF89F8ED5A0A92BC0CFAA7FEADA2FEE0703754721B589BB2A5C7FBE2A35B5AC59C3CA350F6033757F4D99C6CEF58FCF05DF913317585EC6CEB1F3DBDED9ACCCDE4F79C1B787F2C3C6D3D6CBD09C43FAE7D213EB0E9EF30B04A002E7DCCFAAEC8C489F0476C4F405B5537B3EFE99260C1967F52B2FAC40E8B34818DE635209BCC9AC36E74E50EED398B086D7F6653CA48268974A79E6CE05C4C07569B01D1CA26D57EF518A36C2DB1780CE91BF07386D1D4B2D7576D65A13F62F03CEF054BE2D707635889F1C38ED6F45F6843EE039A8FB3528EB0FF14E5BEAF29455C58E4791D697A2EE87A236C9ED2F36ED92BB0CAF6F76EAE870A1F7B5AA7C66DAFD68D531FBD805DF9A857B1FAB1A6E9B13DAF077AA41CE160F623DCEB60F557691B2DE5EDECAD93D1EE5EC490A4F68ED174CAC1092AE2B11FAF74C0E7EE36C9634D77C151545C2B0A820311A991B5004DB47722E145D115FE1B60F52A63F183C1196E8C13D5C4270CDE7898A13852E43B8648D1F2074A9D9A53F7D796CDA3C99C7E9DBFEA77001CDA4BA039EF3EF12CA82D2EEAB965EAA4384AE6179AFAF73A974CFBFDE96926E233E50501EBEB2F43E4018331426E77C415EE110DB1E257C8435F1B7C540DC2DA43F11CDB04F2E28590B12CA5C46C58F5F11C341B879FF1799522532C81F0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '202005051510440_VideoTableChangedToOneGenre'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genre_Id] [int]
    CREATE INDEX [IX_Genre_Id] ON [dbo].[Videos]([Genre_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202005051510440_VideoTableChangedToOneGenre', N'Exercise4.Migrations.Configuration',  0x1F8B0800000000000400ED59DB6EEB44147D47E21F2C3F01EA89D3960788927354D216459C5E54B7156FD5C4DE49478CC766661C2520BE8C073E895F608FEF9E711227E2142450A52A9DD9F7BD665FD23F7FFF63FC611D31670542D2984FDCD3C1D07580077148F972E2A66AF1EE1BF7C3FBCF3F1B5F85D1DA792EE9CE351D727239715F954A469E27835788881C443410B18C176A10C49147C2D83B1B0EBFF54E4F3D40112ECA729CF143CA158D20FB03FF9CC63C8044A584DDC42130599CE38D9F49756E49043221014CDCAB3588804AF8DA752E182568800F6CE13A84F3581185E68D9E24F84AC47CE9277840D8E32601A45B1026A1307B5493F7F56078A63DF06AC65254904A1547070A3C3D2F42E299EC4705D6AD428641BBC2E0AA8DF63A0BDCC4FD1EB840CF4D4DA329139AAA11D441467AE254072755D2111BFAE7C499A64CA502261C5225083B71EED339A3C10FB0798C7F023EE129634D7BD022BC6B1DE0D1BD8813106AF3008BC2CA59E83A5E9BCF33192BB6064FEEC28CABF333D7B945E564CEA04A77C35D5FC502D041104441784F9402C1B50CC80266693774E9DFA536C417BE10D7B921EB8FC097EA75E2E247D7B9A66B08CB93C282274EF14121931229584A6EC98A2E33FB0C75CF348458BACE03B0EC5ABED22407FB20BB7A29B27A2DE2E8216625477EFCF248C412149A1BDB777E9C8AC0B064ECD5A8D989A54C503F2C65A4FF63E9EDB0642841E4009170891696BAF4E747AA755BCEF5C56501BBE3605942AF0B962564FBC0F242CA38A099014D5C16CADB9E5CF1D0D961499E83CA7ECC036292268842D43B71BFB222D32DAF7A70B5BC22126D79C3C1E0D4F4B1E18DFDF6B0392A421168B5A3BF6CB23ED9F10AB1F5150F511618316DD7227D50CD646291A9A3DCB6DD72BDCD5ED6288BBD08A5C1DEF0D39051A2A641D1012AF3DDEFCE6C656C6DA7D74F4299CB86843250665169BBD481DC2A7DF550E3E5534D39FD785BC69FF10D4912AC0C8D71A83871FC7C169ABEF30F9F16A25C8617C88EA1A1B2B6D284758E2CC1B845D568E935155261452173A20BC8348C2CB20658B720A954D4C2A39DA6125F25B9FE9CB318B38BC95B47ED1A1D89B03C673E81995B9B2F1B3F0923A2A34F4C6396467C5BAFD9C59D57FE267F7E624B187B86E166543C2B2C0638CD20F74A41F1568E4B41FEEE0F4FC116BE7F3A05DB24B43A6B5350EBE2ED53DAAE461D792DEBECD6DC9504BD12A4CB67D7D4DA2EA376147AE53497D195591D854AEF612615BDE148930E36062B6148B3216526F5C0550D5B7D1C359B8B9D71ABC7982415DEAA5E63F4947151DFF7EFDD56C1CF495C077D5F6184B1D8FB1BA9201A688281FF339B328A08AF096E08A70B902A9FEC5DDC81CF8C1DFEDFB34F7B5286ACCF52FDE6BB09D521DDBB7DEC9BEE77AC237C4544F04AC41711597FD99464AF1C072E8DFFE958F55ACF42FCAC7AAD675D4BD98BE1B9B51DCC7808EB89FB6BC63472663FBE947C27CE9DC0273A7286CE6FC7E5FCB88DACD18E0E5B9AECD9FD98550E810642E38030ACA15209ACA2564FBEC7F53CA009612D9BED16D207BD3A7E953CF3E61212E01A962DB7FA28DAD52B2BA9C633DAE7FB816BA9BD10F4D83CB72F9E7977C11731D789CDC1B86507EB5C4AB7EFA45D92BBF7C34FB8AFB6BC6F2C217B37547BADFD343BA93D1720621ADFDA2358255DD622F4A8C3216861A5A299F1455C82D6B0A82431EAD90D2882C5905C0845172450781D8094D9F764CF84A57A708DE610CEF85DAA9254A1CB10CD59EB7B370DFD5DFAB3C5BB6DF3F82EC9BED3FA3B5C4033A9AEE777FCBB94B2B0B2FBDAAEE7DB44E83755742E9D4BA53BD8725349BA8D794F4145F8AA52F00851C25098BCE33E59C131B63D49F8084B126CCAF16EBB90FD8968877D7C49C952904816326A7EFD9F284FFF2BEAFD5F9E9E36BEBC1A0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '202005051514356_AddClassificationColumnToVideosTable'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [tinyint] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202005051514356_AddClassificationColumnToVideosTable', N'Exercise4.Migrations.Configuration',  0x1F8B0800000000000400ED59CD6EE33610BE17E83B083AB545D6B2931EDAC0DE45D69B2C8C5D27419404BD05B434768852944A5281DDA24FD6431FA9AFD0A1FE45CA8E6C64D3022D165858E4CC707E3ECE0FF3D71F7F8EDFAD23E63C819034E613773418BA0EF0200E295F4DDC542DDFFCE0BE7BFBF557E3F3305A3BF725DD89A6434E2E27EEA352C9A9E7C9E011222207110D442CE3A51A0471E49130F68E87C31FBDD1C80314E1A22CC719DFA45CD108B20FFC9CC63C8044A584CDE310982CD671C7CFA43A97240299900026EEF91A4440257CEF3A678C1254C007B6741DC279AC8842F54EEF24F84AC47CE527B840D8ED2601A45B1226A150FBB426EF6BC1F0585BE0D58CA5A820952A8EF614383A295CE299EC0739D6AD5C864E3B47E7AA8DB63A73DCC4FD085CA0E5E649A753263455C3A9838CF4C8A9168EAAA02336F4BF23679A32950A9870489520ECC8B94E178C069F60731BFF0C7CC253C69AFAA046B8D75AC0A56B112720D4E606968596B3D075BC369F6732566C0D9EDC84195727C7AE7389879305832ADC0D737D150B4003411005E135510A04D73220739875BA7196FEBF3C0DF18537C475E664FD19F84A3D4E5CFCE93A17740D61B9526870C7295E2864522205EB904BF24457997EC671F7348458BACE0DB06C5B3ED22407FB20DB7A28A27A21E2E826662547BEFC704BC40A14AA1BDB7B7E9C8AC0D064ECD5A8D989A54C503F2C65A4FF63E9F5B0641C82C80122E1036A589EA57FDF527DB665DC6E595346A4A44B1A1439AA505DA3D1DC7A4EF256C417803E0CF025A8BB005F5E867E804FA306DC4DE366F28291555D4DFADC83B68C17B81008831004DB206CF2B3DE6F30C46D2FCF215A8028ACF029C31AEF3AF784A5F839B262D2A2FE18B3B0A23DDE4D7BAD63852EABE84F6C37E70E6D2E9E49190734734733AD14116E1F77CE436747B86B1C1699698E1EA409FA0C833B71BFB3D4EF9657E5CB5A5E01B7B6BCE16030322D6C5863A74EEC6D14A1BC72181EFAEB266B733AC0839D4B811F595C7153772DD207D5BC3158236A28B775B74C6FB39725C6622F5C69B037EC34649457B341D17173CDB4BD3BB295B2B59E5E3F09652C1B124A479935A16D52477AA8C257F7A45EDE9496CDABB7A57B1DCF4992E00D6D74B3C58AE3E7ADECF48DBF7FB317E532BC4076F47C95B6D54958A6C80A8C5D3C1A35BDA0422A2C08644174269B869145D600EB16249507B5F06887A9C45749AE7FE72C46EB69F2D65EBB404322ACAE994D60C6D6E6CBA607C288E828F3D398A511DFD62AECE2CE0B77933F5FB1258C3D4371D32B9EE516039CA6937B85A0B82B878520BFF7FB87600BDF3F1D826D125A8D5153506BA3BF3CB349688A34F75E1F28ED1CD78196327B6F454449D02BEC3A29778D32EDE46C7BA1175272195D78D15EA8CEDD4FA5A2E21CA8D2DECA607E0D69D6FACCA4EE95AB5EB28FA166C9B2236E552E93A4C25B55C18C4A352EAAC6F38F315619C9495C076D7F420F6309F137524134D00403FF17366514115E13CC09A74B902AEF6EDDE3E1E8D878D8F9F73CB2785286ACCF4BCBAB0FAC54BBF4D99174CF91AF39A3F22722824722BE89C8FADBA6247B0EDDF325E13FEDAB5E337B88BFD5CBCDEC38AE6D321FEC29ADCE480D3F5A13CC0C27D3F5C4FD2D633A75663F3D947C47CE95C00B7FEA0C9DDF0F43D0615363A3B8ED37D8D9F3C521E326C216844615619891250EF5D4AEF0D782F2802684B574B60B529FBBA0FD57C933773E40025C83BC65569F837655DE4AAA71299FB37DCFD1D91E5A7A4CC7DB87E3BC56E1FD5AE8C0E660DC3227760ECEDBE7E62EC9DD33EC179CA95BD63706A567A7687BF4FE3273B3DD6520621A7F1842B04ABAAA45E8C68943D0C24A4533E3CBB804ADA1514962E4B3392882A9959C0945972450B81D00E64BFD145BBC659D470B0867FC2A5549AAD0648816ACF5B4ABA1BFEBFCEC71A0ADF3F82AC91E375FC2045493EAEA70C5DFA7B4F1667761E7F36D22F49D2AEAA08EA5D2F570B5A9245DC6BCA7A0C27D552AB8852861284C5E719F3CC121BADD49F80C2B126CCA6671BB90E703D176FBF803252B412259C8A8F9F113311C46EBB77F038AE4B4CF1F1D0000 , N'6.2.0-61023')
END

IF @CurrentMigration < '202005070426515_ModifiedVideoAndGenreTable'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.Videos_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genre_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Genres')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var1 nvarchar(128)
    SELECT @var1 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var1 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var1 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var2 nvarchar(128)
    SELECT @var2 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'GenreId';
    IF @var2 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var2 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [int] NOT NULL
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_GenreId] FOREIGN KEY ([GenreId]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202005070426515_ModifiedVideoAndGenreTable', N'Exercise4.Migrations.Configuration',  0x1F8B0800000000000400ED595F6FDB36107F1FB0EF20E87148ADD859812DB05BA44E5218AB93204A8BBD15B47476885194465281DD619F6C0FFB48FB0A3B4A942C9192E31869BB014580C026EF1FEF7E77BCA3FFF9EBEFF1EB75C2BC071092A67CE20F07C7BE073C4A63CA57133F57CB173FF9AF5F7DFFDDF8224ED6DE878AEE44D321279713FF5EA9EC340864740F09918384462295E9520DA23409489C06A3E3E39F83E1300014E1A32CCF1BDFE65CD1048A2FF8759AF208329513364F6360D2ACE34E5848F5AE48023223114CFC8B3588884AF8D1F7CE18256840086CE97B84F3541185E69DBE97102A91F25598E10261779B0C906E49980463F6E9967CDF131C8FF409822D63252ACAA54A93270A1C9E18970436FB418EF56B97A1D32ED0B96AA34F5D386EE2BF052EF0E4B6A6D329139AAAE1D441417AE4D50B4775D0111BFAEFC89BE64CE502261C7225083BF26EF205A3D12FB0B94B7F033EE139634D7BD022DC6B2DE0D28D4833106A730B4B63E52CF6BDA0CD17D88C355B83A73CC28CAB9391EF5DA172B2605087BB71DC50A502F080208882F8862805826B195038CCD16EE9D2FF2B6D882FCC10DF9B93F53BE02B753FF1472F5FFADE255D435CAD180BDE738A09854C4AE4D061A1A5F58A3CD05561B0A5FF038D2195BE770BACD896F7342BD13F28B63E9A305F8A34B94D59C5512E7FBC2362050AED4FDDBD30CD456459320EB630DA09AE42D07EE02A48BF81EB2B82CBD28A500222E11C4DAE94EBCF773479BAAC024A8FBB6CB790292352D2258D4C29340ED118B7B70ECE23932687A551952A5D6954A5D87E6994278D24B20F3793978CACB697D63ED9D596F10C6986E08A41B00D82B1D4F5668338697B790EC9028439454819B612BEF781B01CBF0E9D98B4A8DFA62CAE6947BB696F74ACD06535FD89EBE6D2A1CDC53329D38816EE68162B13E1B6BA0B1E7B3BC2BDC5A1A97773F420CDD06718DC89FF83637EB7BCBA0A6FE519B8B5E50D7DBBA45DF3734C5605DE5954361953222312BBB8474FC4ED15AC82207419220C3B2D8901A75CB92593F2886684F55B6DB1EC5967B549B5707BE71C32E0BA44F6FB7E1FAD75ED7155D71A2C2F3DE69471D0408F7B01228F428E1AA068F8A74DD1BD76242B36A4265FA529D43656B4C81054F33878D36F4B471B2B0ED4DAEC55A3E0B01BE85AEC8D735A32AA52D8A0E8A894B6CB7767526DECD64E2768BB73A721A172949D02ED237594E33A7CDB512328678D6A26097A8692F19C641956C4C6906256BCB09C50A62FC2A7F7F04929238864472B5F5B5B6BC26683ACC0DA45D568E9251552E12D4E1644DF1CD33871C81A60ED4152A5A88547374C15BE2A72FDB964B1268A8E2C363C977890441780A281B263EBF2154321614474346BD394E509EF2F44FDDC65FBD5E42F575C09E3C032DCA9388E5B9CFADC76F25E2130B9725808CABC7F7A087AF8BE7608FA24B4BAD9A6A0D6C6FEF2EA5BA529ABF7AAE9976337774D71F6DE17069C530F6D925A7B5D17ADFA3736B5E8F1971BA7389524BE87EE7A40A461610A37524132D00483F077366514CFBB2598134E972055D9A3FAA3E3E1C87A05FAEFBCC80452C66C9F67992F3ECC52EDD247C7D5270E6ECDF9953F1011DD13E14EB03B853EF1C5E19BDF7A85768CF5317E56CF30D6174E701ADC1976D8EB89FF47C173EACD7EFD68D88EBC6B81897BEA1D7B7F3ED36300CE819BC28A83C074D84868FAE02F3AB5594DF02133E841835F5FBFF67966BDFFC978E736D67B4C70FD035C79F361562E745C4B10F7CC329DC35DFF6CD725B97BCEFA8C735FEBF48D66FED149CF1D0F3FCF6CE7F62C8898C66F52885549575B11FA172A0E510B2B35CD8C2FD30AB39645158955D8E6A00816647226145D9248E1760458EAF4A3AF79DFBA481610CFF875AEB25CE1912159B0D623B286FE2EFDC500DBB6797C9D150F9ECF71043493EA3BE59ABFC969E31DEFB2A314F788D039656E521D4BA56FD4D5A6967495F23D0519F7D5A5E00E928CA13079CD43F20087D8F65EC23B58916853B59EFD421E0F44DBEDE3734A568224D2C8D8F2E357C4709CAC5FFD0BCBBD4CAD9A1D0000 , N'6.2.0-61023')
END

